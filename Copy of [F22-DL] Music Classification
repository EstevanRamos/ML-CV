{"cells":[{"cell_type":"markdown","metadata":{"id":"VqEEMulen8lr"},"source":["## Before you start\n","Make a copy of this Colab by clicking on File \u003e Save a Copy in Drive\n","Input your student id, first name, and last name"]},{"cell_type":"code","execution_count":15,"metadata":{"executionInfo":{"elapsed":215,"status":"ok","timestamp":1664065301007,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"0k27GPzIoBsn"},"outputs":[],"source":["#@title  { run: \"auto\", display-mode: \"form\" }\n","student_id = \"80605797\" #@param {type:\"string\"}\n","first_name = \"Estevan\" #@param {type:\"string\"}\n","last_name = \"Ramos\" #@param {type:\"string\"}"]},{"cell_type":"markdown","metadata":{"id":"A0zHPIADAz5S"},"source":["## Download NES Music Dataset"]},{"cell_type":"code","execution_count":16,"metadata":{"executionInfo":{"elapsed":2049,"status":"ok","timestamp":1664065307879,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"NB2VapsrBazm"},"outputs":[],"source":["from urllib import request\n","\n","nes_midi_url = \"http://deepyeti.ucsd.edu/cdonahue/nesmdb/nesmdb_midi.tar.gz\"\n","nes_midi_tar_path = \"nesmdb_midi.tar.gz\"\n","\n","nes_exprsco_url = \"http://deepyeti.ucsd.edu/cdonahue/nesmdb/nesmdb24_exprsco.tar.gz\"\n","nes_exprsco_tar_path = \"nesmdb24_exprsco.tar.gz\"\n","\n","def download_ds(url, store_path):\n","  response = request.urlretrieve(url, store_path)\n","\n","\n","download_ds(nes_midi_url, nes_midi_tar_path)\n","download_ds(nes_exprsco_url, nes_exprsco_tar_path)\n","\n","midi_train_path = \"nesmdb_midi/train/\"\n","exprsco_train_path = \"nesmdb24_exprsco/train/\"\n"]},{"cell_type":"markdown","metadata":{"id":"NP0MOZCLB7rb"},"source":["## Decompress "]},{"cell_type":"code","execution_count":17,"metadata":{"executionInfo":{"elapsed":6354,"status":"ok","timestamp":1664065322980,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"vvwEzmgSAvaY"},"outputs":[],"source":["import tarfile\n","\n","def decompress(path):\n","  tar = tarfile.open(path)\n","  tar.extractall()\n","  tar.close()\n","\n","decompress(nes_midi_tar_path)\n","decompress(nes_exprsco_tar_path)"]},{"cell_type":"markdown","metadata":{"id":"_PhhmCieG1zy"},"source":["## Split Dataset "]},{"cell_type":"code","execution_count":18,"metadata":{"executionInfo":{"elapsed":239,"status":"ok","timestamp":1664065334186,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"eT8EHx9RDtVp"},"outputs":[],"source":["import os\n","from collections import defaultdict\n","\n","\n","def get_video_game_dataset(num_top_games):\n","  dir_list = os.listdir(midi_train_path)\n","  \n","  game_tracks = defaultdict(list)\n","  for mid_file in dir_list:\n","    game_id = mid_file[:3]\n","    game_tracks[game_id].append(mid_file)\n","    \n","  game_tracks = {k: v for k, v in sorted(game_tracks.items(), key=lambda item: len(item[1]), reverse=True)}\n","\n","  key_iterator = iter(game_tracks)\n","\n","  game_tracks_sub = {}\n","  for _ in range(num_top_games):\n","    video_game = next(key_iterator)  \n","    game_tracks_sub[video_game] = game_tracks[video_game]\n","\n","  return game_tracks_sub\n","\n","\n","num_top_games = 10\n","game_tracks = get_video_game_dataset(num_top_games)\n","  "]},{"cell_type":"code","execution_count":19,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1375,"status":"ok","timestamp":1664065338314,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"u7YSeh7Mmg6X","outputId":"dc87f5e6-7cfc-48c3-df6e-a59c1c864380"},"outputs":[{"name":"stdout","output_type":"stream","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"markdown","metadata":{"id":"R2HlxrEzHRC4"},"source":["## Play some tracks"]},{"cell_type":"markdown","metadata":{"id":"xARIyCBMHjRX"},"source":["### Install Dependencies"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":118465,"status":"ok","timestamp":1664064577196,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"nfQasYlVHlT0","outputId":"29c3e6ab-cb6f-4b6e-e4f4-f06e5cf453d0"},"outputs":[{"name":"stdout","output_type":"stream","text":["\u001b[K     |████████████████████████████████| 1.4 MB 4.0 MB/s \n","\u001b[K     |████████████████████████████████| 5.6 MB 25.9 MB/s \n","\u001b[K     |████████████████████████████████| 11.2 MB 36.3 MB/s \n","\u001b[K     |████████████████████████████████| 3.6 MB 28.9 MB/s \n","\u001b[K     |████████████████████████████████| 69 kB 7.8 MB/s \n","\u001b[K     |████████████████████████████████| 6.5 MB 60.5 MB/s \n","\u001b[K     |████████████████████████████████| 3.4 MB 47.2 MB/s \n","\u001b[K     |████████████████████████████████| 254 kB 67.3 MB/s \n","\u001b[K     |████████████████████████████████| 210 kB 74.7 MB/s \n","\u001b[K     |████████████████████████████████| 204 kB 61.4 MB/s \n","\u001b[K     |████████████████████████████████| 352 kB 60.1 MB/s \n","\u001b[K     |████████████████████████████████| 13.5 MB 56.4 MB/s \n","\u001b[K     |████████████████████████████████| 3.1 MB 60.6 MB/s \n","\u001b[K     |████████████████████████████████| 1.6 MB 45.3 MB/s \n","\u001b[K     |████████████████████████████████| 90 kB 8.8 MB/s \n","\u001b[K     |████████████████████████████████| 511.7 MB 5.2 kB/s \n","\u001b[K     |████████████████████████████████| 2.3 MB 53.2 MB/s \n","\u001b[K     |████████████████████████████████| 959 kB 55.1 MB/s \n","\u001b[K     |████████████████████████████████| 20.2 MB 844 kB/s \n","\u001b[K     |████████████████████████████████| 438 kB 44.1 MB/s \n","\u001b[K     |████████████████████████████████| 1.6 MB 48.6 MB/s \n","\u001b[K     |████████████████████████████████| 5.8 MB 52.5 MB/s \n","\u001b[K     |████████████████████████████████| 3.1 MB 51.5 MB/s \n","\u001b[K     |████████████████████████████████| 3.1 MB 46.9 MB/s \n","\u001b[K     |████████████████████████████████| 3.1 MB 31.5 MB/s \n","\u001b[K     |████████████████████████████████| 1.6 MB 56.6 MB/s \n","\u001b[?25h  Building wheel for librosa (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Building wheel for mir-eval (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Building wheel for pretty-midi (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Building wheel for python-rtmidi (setup.py) ... \u001b[?25l\u001b[?25hdone\n"]}],"source":["!pip install -qU magenta"]},{"cell_type":"markdown","metadata":{"id":"z4fQhdbpH3C1"},"source":["### Play some tracks"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"n5pT4NNZHQk4"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/librosa/util/decorators.py:9: NumbaDeprecationWarning: An import was requested from a module that has moved location.\n","Import requested from: 'numba.decorators', please update to use 'numba.core.decorators' or pin to Numba version 0.48.0. This alias will not be present in Numba version 0.50.0.\n","  from numba.decorators import jit as optional_jit\n","/usr/local/lib/python3.7/dist-packages/librosa/util/decorators.py:9: NumbaDeprecationWarning: An import was requested from a module that has moved location.\n","Import of 'jit' requested from: 'numba.decorators', please update to use 'numba.core.decorators' or pin to Numba version 0.48.0. This alias will not be present in Numba version 0.50.0.\n","  from numba.decorators import jit as optional_jit\n","/usr/local/lib/python3.7/dist-packages/resampy/interpn.py:114: NumbaWarning: The TBB threading layer requires TBB version 2019.5 or later i.e., TBB_INTERFACE_VERSION \u003e= 11005. Found TBB_INTERFACE_VERSION = 9107. The TBB threading layer is disabled.\n","  _resample_loop_p(x, t_out, interp_win, interp_delta, num_table, scale, y)\n"]},{"name":"stdout","output_type":"stream","text":["Track Name: 119_FinalFantasyIII_04_05CrystalRoom.mid\n"]},{"data":{"text/html":["\u003cdiv id=\"id_1\"\u003e \u003c/div\u003e"],"text/plain":["\u003cIPython.core.display.HTML object\u003e"]},"metadata":{},"output_type":"display_data"},{"name":"stdout","output_type":"stream","text":["Track Name: 091_DragonWarriorIV_14_15LevelUp.mid\n"]},{"data":{"text/html":["\u003cdiv id=\"id_2\"\u003e \u003c/div\u003e"],"text/plain":["\u003cIPython.core.display.HTML object\u003e"]},"metadata":{},"output_type":"display_data"},{"name":"stdout","output_type":"stream","text":["Track Name: 229_MegaMan6_05_06GameStart.mid\n"]},{"data":{"text/html":["\u003cdiv id=\"id_3\"\u003e \u003c/div\u003e"],"text/plain":["\u003cIPython.core.display.HTML object\u003e"]},"metadata":{},"output_type":"display_data"}],"source":["import note_seq\n","\n","games_sub = [\"119\", \"091\", \"229\"]\n","for game_id in games_sub:\n","  tracks = game_tracks[game_id]\n","  first_track = note_seq.midi_file_to_note_sequence(midi_train_path + \"/\" + tracks[0])\n","  print(f'Track Name: {tracks[0]}')\n","  note_seq.play_sequence(first_track)\n","\n"]},{"cell_type":"markdown","metadata":{"id":"Wy5BQKTdOWjM"},"source":["## Read NumPy representations"]},{"cell_type":"code","execution_count":7,"metadata":{"executionInfo":{"elapsed":203,"status":"ok","timestamp":1664064657067,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"u6tJyW7AOgGY"},"outputs":[],"source":["import numpy as np\n","\n","game_tracks_np = defaultdict(list)\n","\n","tss = []\n","for game_id in game_tracks:  \n","  for track in game_tracks[game_id]:\n","    exprsco_path = exprsco_train_path + track.replace(\".mid\",\".exprsco.pkl\")\n","    np_rep = np.load(exprsco_path, allow_pickle=True)[2]\n","\n","    game_tracks_np[game_id].append(np_rep)\n","    tss.append(np_rep.shape[0])\n"]},{"cell_type":"markdown","metadata":{"id":"Nfn1KmOaQ7zg"},"source":["## Train-Test Split\n","\n"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":220,"status":"ok","timestamp":1664064694839,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"rB2OL6i4QGEC","outputId":"8fec5811-850f-44ed-c561-521f5ecc93e4"},"outputs":[{"name":"stdout","output_type":"stream","text":["(386, 460, 4, 3) (386,) (101, 460, 4, 3) (101,)\n","0.0 108.0 11.113054742059022\n"]}],"source":["def train_test_split(game_tracks_np, max_timesteps=460, test_ratio=0.2):\n","  x_train_lst = []\n","  y_train_lst = []\n","\n","  x_test_lst = []\n","  y_test_lst = []\n","  for class_id, game_id in enumerate(game_tracks_np):\n","    tracks_lst = game_tracks_np[game_id]\n","    test_idx = int(len(tracks_lst) * (1 - test_ratio))\n","    x_train_lst.extend(tracks_lst[:test_idx])\n","    y_train_lst.extend([class_id for _ in range(test_idx)])\n","\n","    x_test_lst.extend(tracks_lst[test_idx:])\n","    y_test_lst.extend([class_id for _ in tracks_lst[test_idx:]])\n","\n","  x_train = np.zeros((len(x_train_lst), max_timesteps, 4, 3))  # 4 and 3 come from https://github.com/chrisdonahue/nesmdb#download-links\n","  x_test = np.zeros((len(x_test_lst), max_timesteps, 4, 3))\n","\n","  for idx, np_rep in enumerate(x_train_lst):\n","    ts = min(max_timesteps, np_rep.shape[0])\n","    x_train[idx, :ts] = np_rep[:ts]\n","\n","  for idx, np_rep in enumerate(x_test_lst):\n","    ts = min(max_timesteps, np_rep.shape[0])\n","    x_test[idx, :ts] = np_rep[:ts]\n","  \n","  y_train = np.array(y_train_lst)\n","  y_test = np.array(y_test_lst)\n","\n","  return x_train, y_train, x_test, y_test\n","\n","x_train, y_train, x_test, y_test = train_test_split(game_tracks_np)\n","\n","print(x_train.shape, y_train.shape, x_test.shape, y_test.shape)\n","\n","print(x_train.min(), x_train.max(), x_train.mean())\n","\n","  "]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":191,"status":"ok","timestamp":1664064701054,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"p2WeXg-Qd_c6","outputId":"649306b0-74dc-4b16-ff7c-83273072c30f"},"outputs":[{"name":"stdout","output_type":"stream","text":["(386, 460, 12) (386,) (101, 460, 12) (101,)\n"]}],"source":["x_train = x_train.reshape(x_train.shape[0], x_train.shape[1], -1)\n","x_test = x_test.reshape(x_test.shape[0], x_test.shape[1], -1)\n","\n","print(x_train.shape, y_train.shape, x_test.shape, y_test.shape)"]},{"cell_type":"code","execution_count":10,"metadata":{"executionInfo":{"elapsed":2942,"status":"ok","timestamp":1664064772262,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"_ZrwgtVwYBTI"},"outputs":[],"source":["# Import the libraries we'll use below.\n","import numpy as np\n","from matplotlib import pyplot as plt\n","import pandas as pd\n","import seaborn as sns  # for nicer plots\n","sns.set(style=\"darkgrid\")  # default style\n","\n","import tensorflow as tf\n","from tensorflow import keras\n","from keras import metrics\n","from keras.preprocessing.image import ImageDataGenerator\n"]},{"cell_type":"code","execution_count":11,"metadata":{"executionInfo":{"elapsed":235,"status":"ok","timestamp":1664064823419,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"FcYONY-9X9ot"},"outputs":[],"source":["def build_model(input_shape=(460, 12), learning_rate=0.01):\n","  \"\"\"Build a TF logistic regression model using Keras.\n","\n","  Args:\n","    input_shape: The shape of the model's input. \n","    learning_rate: The desired learning rate for SGD.\n","\n","  Returns:\n","    model: A tf.keras model (graph).\n","  \"\"\"\n","  # This is not strictly necessary, but each time you build a model, TF adds\n","  # new nodes (rather than overwriting), so the colab session can end up\n","  # storing lots of copies of the graph when you only care about the most\n","  # recent. Also, as there is some randomness built into training with SGD,\n","  # setting a random seed ensures that results are the same on each identical\n","  # training run.\n","  tf.keras.backend.clear_session()\n","  np.random.seed(0)\n","  tf.random.set_seed(0)\n","\n","  num_classes = 10\n","\n","  model = keras.Sequential()\n","\n","  model.add(keras.layers.Conv1D(filters=32, kernel_size=12, padding='same',\n","                  input_shape=input_shape))\n","  \n","  model.add(keras.layers.Activation('relu'))\n","  model.add(keras.layers.Conv1D(filters=32, kernel_size=12))\n","\n","\n","  model.add(keras.layers.Activation('relu'))\n","  model.add(keras.layers.MaxPooling1D(pool_size=4))\n","\n","  model.add(keras.layers.Conv1D(filters=64, kernel_size=12, padding='same'))\n","  model.add(keras.layers.Activation('relu'))\n","\n","  model.add(keras.layers.Conv1D(filters=64, kernel_size=12))\n","\n","  model.add(keras.layers.Activation('relu'))\n","  model.add(keras.layers.MaxPooling1D(pool_size=4))\n","  \n","  model.add(keras.layers.Flatten())\n","\n","  model.add(keras.layers.Dense(units=512))\n","\n","  model.add(keras.layers.Activation('relu'))\n","\n","  model.add(keras.layers.Dense(units=num_classes))\n","  model.add(keras.layers.Activation('softmax'))\n","  # We need to choose an optimizer. We'll use SGD, which is actually mini-batch\n","  # SGD. We can specify the batch size to use for training later.\n","  optimizer = tf.keras.optimizers.SGD(learning_rate=learning_rate)\n","  # Finally, we compile the model. This finalizes the graph for training.\n","  model.compile(loss=keras.losses.sparse_categorical_crossentropy,\n","              optimizer=optimizer,\n","              metrics=['accuracy'])\n","\n","\n","  return model"]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":1235,"status":"error","timestamp":1664064963213,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"ybx3S8fTereq","outputId":"c0d48531-c223-4404-fa5c-99c3dec0a5b8"},"outputs":[{"name":"stdout","output_type":"stream","text":["Model: \"sequential\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," conv1d (Conv1D)             (None, 460, 32)           4640      \n","                                                                 \n"," activation (Activation)     (None, 460, 32)           0         \n","                                                                 \n"," conv1d_1 (Conv1D)           (None, 449, 32)           12320     \n","                                                                 \n"," activation_1 (Activation)   (None, 449, 32)           0         \n","                                                                 \n"," max_pooling1d (MaxPooling1D  (None, 112, 32)          0         \n"," )                                                               \n","                                                                 \n"," conv1d_2 (Conv1D)           (None, 112, 64)           24640     \n","                                                                 \n"," activation_2 (Activation)   (None, 112, 64)           0         \n","                                                                 \n"," conv1d_3 (Conv1D)           (None, 101, 64)           49216     \n","                                                                 \n"," activation_3 (Activation)   (None, 101, 64)           0         \n","                                                                 \n"," max_pooling1d_1 (MaxPooling  (None, 25, 64)           0         \n"," 1D)                                                             \n","                                                                 \n"," flatten (Flatten)           (None, 1600)              0         \n","                                                                 \n"," dense (Dense)               (None, 512)               819712    \n","                                                                 \n"," activation_4 (Activation)   (None, 512)               0         \n","                                                                 \n"," dense_1 (Dense)             (None, 10)                5130      \n","                                                                 \n"," activation_5 (Activation)   (None, 10)                0         \n","                                                                 \n","=================================================================\n","Total params: 915,658\n","Trainable params: 915,658\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/200\n"]},{"ename":"UnimplementedError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mUnimplementedError\u001b[0m                        Traceback (most recent call last)","\u001b[0;32m\u003cipython-input-14-029287597de0\u003e\u001b[0m in \u001b[0;36m\u003cmodule\u003e\u001b[0;34m\u001b[0m\n\u001b[1;32m     11\u001b[0m   \u001b[0mshuffle\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     12\u001b[0m   \u001b[0mvalidation_data\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx_test\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_test\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;31m# use a fraction of the examples for validation\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 13\u001b[0;31m   \u001b[0mverbose\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m             \u001b[0;31m# display some progress output during training\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     14\u001b[0m   )\n\u001b[1;32m     15\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\u001b[0m in \u001b[0;36merror_handler\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m     65\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m  \u001b[0;31m# pylint: disable=broad-except\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     66\u001b[0m       \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_process_traceback_frames\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__traceback__\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 67\u001b[0;31m       \u001b[0;32mraise\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwith_traceback\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfiltered_tb\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     68\u001b[0m     \u001b[0;32mfinally\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     69\u001b[0m       \u001b[0;32mdel\u001b[0m \u001b[0mfiltered_tb\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/execute.py\u001b[0m in \u001b[0;36mquick_execute\u001b[0;34m(op_name, num_outputs, inputs, attrs, ctx, name)\u001b[0m\n\u001b[1;32m     53\u001b[0m     \u001b[0mctx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mensure_initialized\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     54\u001b[0m     tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,\n\u001b[0;32m---\u003e 55\u001b[0;31m                                         inputs, attrs, num_outputs)\n\u001b[0m\u001b[1;32m     56\u001b[0m   \u001b[0;32mexcept\u001b[0m \u001b[0mcore\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_NotOkStatusException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     57\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mname\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mUnimplementedError\u001b[0m: Graph execution error:\n\nDetected at node 'sequential/conv1d/Conv1D' defined at (most recent call last):\n    File \"/usr/lib/python3.7/runpy.py\", line 193, in _run_module_as_main\n      \"__main__\", mod_spec)\n    File \"/usr/lib/python3.7/runpy.py\", line 85, in _run_code\n      exec(code, run_globals)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py\", line 16, in \u003cmodule\u003e\n      app.launch_new_instance()\n    File \"/usr/local/lib/python3.7/dist-packages/traitlets/config/application.py\", line 846, in launch_instance\n      app.start()\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/kernelapp.py\", line 612, in start\n      self.io_loop.start()\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/platform/asyncio.py\", line 132, in start\n      self.asyncio_loop.run_forever()\n    File \"/usr/lib/python3.7/asyncio/base_events.py\", line 541, in run_forever\n      self._run_once()\n    File \"/usr/lib/python3.7/asyncio/base_events.py\", line 1786, in _run_once\n      handle._run()\n    File \"/usr/lib/python3.7/asyncio/events.py\", line 88, in _run\n      self._context.run(self._callback, *self._args)\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/ioloop.py\", line 758, in _run_callback\n      ret = callback()\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/stack_context.py\", line 300, in null_wrapper\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/gen.py\", line 1233, in inner\n      self.run()\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/gen.py\", line 1147, in run\n      yielded = self.gen.send(value)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/kernelbase.py\", line 365, in process_one\n      yield gen.maybe_future(dispatch(*args))\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/gen.py\", line 326, in wrapper\n      yielded = next(result)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/kernelbase.py\", line 268, in dispatch_shell\n      yield gen.maybe_future(handler(stream, idents, msg))\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/gen.py\", line 326, in wrapper\n      yielded = next(result)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/kernelbase.py\", line 545, in execute_request\n      user_expressions, allow_stdin,\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/gen.py\", line 326, in wrapper\n      yielded = next(result)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/ipkernel.py\", line 306, in do_execute\n      res = shell.run_cell(code, store_history=store_history, silent=silent)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/zmqshell.py\", line 536, in run_cell\n      return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\", line 2855, in run_cell\n      raw_cell, store_history, silent, shell_futures)\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\", line 2881, in _run_cell\n      return runner(coro)\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/async_helpers.py\", line 68, in _pseudo_sync_runner\n      coro.send(None)\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\", line 3058, in run_cell_async\n      interactivity=interactivity, compiler=compiler, result=result)\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\", line 3249, in run_ast_nodes\n      if (await self.run_code(code, result,  async_=asy)):\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\", line 3326, in run_code\n      exec(code_obj, self.user_global_ns, self.user_ns)\n    File \"\u003cipython-input-14-029287597de0\u003e\", line 13, in \u003cmodule\u003e\n      verbose=1             # display some progress output during training\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 1409, in fit\n      tmp_logs = self.train_function(iterator)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 1051, in train_function\n      return step_function(self, iterator)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 1040, in step_function\n      outputs = model.distribute_strategy.run(run_step, args=(data,))\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 1030, in run_step\n      outputs = model.train_step(data)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 889, in train_step\n      y_pred = self(x, training=True)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 490, in __call__\n      return super().__call__(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/base_layer.py\", line 1014, in __call__\n      outputs = call_fn(inputs, *args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 92, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/sequential.py\", line 374, in call\n      return super(Sequential, self).call(inputs, training=training, mask=mask)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/functional.py\", line 459, in call\n      inputs, training=training, mask=mask)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/functional.py\", line 596, in _run_internal_graph\n      outputs = node.layer(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/base_layer.py\", line 1014, in __call__\n      outputs = call_fn(inputs, *args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 92, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/layers/convolutional/base_conv.py\", line 250, in call\n      outputs = self.convolution_op(inputs, self.kernel)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/layers/convolutional/base_conv.py\", line 232, in convolution_op\n      name=self.__class__.__name__)\nNode: 'sequential/conv1d/Conv1D'\nDNN library is not found.\n\t [[{{node sequential/conv1d/Conv1D}}]] [Op:__inference_train_function_1967]"]}],"source":["model = build_model(input_shape=x_train[0].shape, learning_rate=0.001)\n","\n","model.summary()\n","\n","# Fit the model.\n","history = model.fit(\n","  x = x_train,   # our binary training examples\n","  y = y_train,   # corresponding binary labels\n","  epochs=200,             # number of passes through the training data\n","  batch_size=64,        # mini-batch size for SGD\n","  shuffle=True,\n","  validation_data=(x_test, y_test), # use a fraction of the examples for validation\n","  verbose=1             # display some progress output during training\n","  )\n","\n","# Convert the return value into a DataFrame so we can see the train loss \n","# and binary accuracy after every epoch.\n","history = pd.DataFrame(history.history)\n","display(history)"]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":481,"status":"error","timestamp":1664064854304,"user":{"displayName":"Estevan Ramos","userId":"16831403701789948978"},"user_tz":360},"id":"RxC3BUItj2yl","outputId":"00557541-85be-468a-cc69-9df87fc4f9bc"},"outputs":[{"ename":"UnimplementedError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mUnimplementedError\u001b[0m                        Traceback (most recent call last)","\u001b[0;32m\u003cipython-input-13-f987ec127082\u003e\u001b[0m in \u001b[0;36m\u003cmodule\u003e\u001b[0;34m\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0msklearn\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmetrics\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0maccuracy_score\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----\u003e 3\u001b[0;31m \u001b[0my_pred\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx_test\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      4\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_pred\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0margmax\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_pred\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\u001b[0m in \u001b[0;36merror_handler\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m     65\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m  \u001b[0;31m# pylint: disable=broad-except\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     66\u001b[0m       \u001b[0mfiltered_tb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_process_traceback_frames\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__traceback__\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 67\u001b[0;31m       \u001b[0;32mraise\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwith_traceback\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfiltered_tb\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     68\u001b[0m     \u001b[0;32mfinally\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     69\u001b[0m       \u001b[0;32mdel\u001b[0m \u001b[0mfiltered_tb\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/tensorflow/python/eager/execute.py\u001b[0m in \u001b[0;36mquick_execute\u001b[0;34m(op_name, num_outputs, inputs, attrs, ctx, name)\u001b[0m\n\u001b[1;32m     53\u001b[0m     \u001b[0mctx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mensure_initialized\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     54\u001b[0m     tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,\n\u001b[0;32m---\u003e 55\u001b[0;31m                                         inputs, attrs, num_outputs)\n\u001b[0m\u001b[1;32m     56\u001b[0m   \u001b[0;32mexcept\u001b[0m \u001b[0mcore\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_NotOkStatusException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     57\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mname\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mUnimplementedError\u001b[0m: Graph execution error:\n\nDetected at node 'sequential/conv1d/Conv1D' defined at (most recent call last):\n    File \"/usr/lib/python3.7/runpy.py\", line 193, in _run_module_as_main\n      \"__main__\", mod_spec)\n    File \"/usr/lib/python3.7/runpy.py\", line 85, in _run_code\n      exec(code, run_globals)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py\", line 16, in \u003cmodule\u003e\n      app.launch_new_instance()\n    File \"/usr/local/lib/python3.7/dist-packages/traitlets/config/application.py\", line 846, in launch_instance\n      app.start()\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/kernelapp.py\", line 612, in start\n      self.io_loop.start()\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/platform/asyncio.py\", line 132, in start\n      self.asyncio_loop.run_forever()\n    File \"/usr/lib/python3.7/asyncio/base_events.py\", line 541, in run_forever\n      self._run_once()\n    File \"/usr/lib/python3.7/asyncio/base_events.py\", line 1786, in _run_once\n      handle._run()\n    File \"/usr/lib/python3.7/asyncio/events.py\", line 88, in _run\n      self._context.run(self._callback, *self._args)\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/ioloop.py\", line 758, in _run_callback\n      ret = callback()\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/stack_context.py\", line 300, in null_wrapper\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/gen.py\", line 1233, in inner\n      self.run()\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/gen.py\", line 1147, in run\n      yielded = self.gen.send(value)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/kernelbase.py\", line 365, in process_one\n      yield gen.maybe_future(dispatch(*args))\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/gen.py\", line 326, in wrapper\n      yielded = next(result)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/kernelbase.py\", line 268, in dispatch_shell\n      yield gen.maybe_future(handler(stream, idents, msg))\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/gen.py\", line 326, in wrapper\n      yielded = next(result)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/kernelbase.py\", line 545, in execute_request\n      user_expressions, allow_stdin,\n    File \"/usr/local/lib/python3.7/dist-packages/tornado/gen.py\", line 326, in wrapper\n      yielded = next(result)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/ipkernel.py\", line 306, in do_execute\n      res = shell.run_cell(code, store_history=store_history, silent=silent)\n    File \"/usr/local/lib/python3.7/dist-packages/ipykernel/zmqshell.py\", line 536, in run_cell\n      return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\", line 2855, in run_cell\n      raw_cell, store_history, silent, shell_futures)\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\", line 2881, in _run_cell\n      return runner(coro)\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/async_helpers.py\", line 68, in _pseudo_sync_runner\n      coro.send(None)\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\", line 3058, in run_cell_async\n      interactivity=interactivity, compiler=compiler, result=result)\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\", line 3249, in run_ast_nodes\n      if (await self.run_code(code, result,  async_=asy)):\n    File \"/usr/local/lib/python3.7/dist-packages/IPython/core/interactiveshell.py\", line 3326, in run_code\n      exec(code_obj, self.user_global_ns, self.user_ns)\n    File \"\u003cipython-input-13-f987ec127082\u003e\", line 3, in \u003cmodule\u003e\n      y_pred = model.predict(x_test)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 2033, in predict\n      tmp_batch_outputs = self.predict_function(iterator)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 1845, in predict_function\n      return step_function(self, iterator)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 1834, in step_function\n      outputs = model.distribute_strategy.run(run_step, args=(data,))\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 1823, in run_step\n      outputs = model.predict_step(data)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 1791, in predict_step\n      return self(x, training=False)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/training.py\", line 490, in __call__\n      return super().__call__(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/base_layer.py\", line 1014, in __call__\n      outputs = call_fn(inputs, *args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 92, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/sequential.py\", line 374, in call\n      return super(Sequential, self).call(inputs, training=training, mask=mask)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/functional.py\", line 459, in call\n      inputs, training=training, mask=mask)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/functional.py\", line 596, in _run_internal_graph\n      outputs = node.layer(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 64, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/engine/base_layer.py\", line 1014, in __call__\n      outputs = call_fn(inputs, *args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/utils/traceback_utils.py\", line 92, in error_handler\n      return fn(*args, **kwargs)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/layers/convolutional/base_conv.py\", line 250, in call\n      outputs = self.convolution_op(inputs, self.kernel)\n    File \"/usr/local/lib/python3.7/dist-packages/keras/layers/convolutional/base_conv.py\", line 232, in convolution_op\n      name=self.__class__.__name__)\nNode: 'sequential/conv1d/Conv1D'\nDNN library is not found.\n\t [[{{node sequential/conv1d/Conv1D}}]] [Op:__inference_predict_function_1054]"]}],"source":["from sklearn.metrics import accuracy_score\n","\n","y_pred = model.predict(x_test)\n","print(y_pred)\n","print(np.argmax(y_pred, axis=1))\n","print(y_test)\n","print(accuracy_score(np.argmax(y_pred, axis=1), y_test))"]},{"cell_type":"markdown","metadata":{"id":"rloQUkYeg8t1"},"source":["##Exercises:\n","\n","1. Identify 5 songs that were misclassified and play them\n","2. Print the confusion matrix for the model's predictions\n","3. Play around with the model and tweak it. Add layers/remove layers, tweak hyperparameters etc. Write about some of the things that you notice from this experience\n"]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"machine_shape":"hm","name":"","provenance":[{"file_id":"1E2LhFkUstDL0rvOsTi28knb7rWcLulRa","timestamp":1663776720223}],"version":""},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}